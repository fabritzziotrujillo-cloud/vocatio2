<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Configuración de Perfil - OrientaVocacional</title>
  <link rel="stylesheet" href="../../styles/global.css">
  <link rel="stylesheet" href="../../styles/style.css">
  <link rel="stylesheet" href="components/configuracion-perfil.css">
  <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
  <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-L4NYN4CHVR"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-L4NYN4CHVR');
</script>
</head>
<body>

  <!-- Mobile Header -->
  <header class="mobile-header">
    <div class="mobile-header-content">
      <div class="logo-icon-small">V</div>
      <span class="logo-text-small">Vocatio</span>
    </div>
  </header>

  <!-- Desktop Navbar -->
<nav class="navbar">
  <div class="navbar-container">
    <div class="logo">
      <div class="logo-icon">V</div>
      <span class="logo-text">Vocatio</span>
    </div>

    <div class="nav-items">
      <a href="../inicio.html" class="nav-link">
        <i data-lucide="home"></i>
        <span>Inicio</span>
      </a>
      <a href="../TestVocacional/test-vocacional-seccion.html" class="nav-link">
        <i data-lucide="clipboard-check"></i>
        <span>Test Vocacional</span>
      </a>
      <a href="../ExplorarCarreras/explorar-carreras-seccion.html" class="nav-link">
        <i data-lucide="search"></i>
        <span>Explorar Carreras</span>
      </a>
      <a href="../Perfil/perfil-seccion.html" class="nav-link active">
        <i data-lucide="user"></i>
        <span>Mi Perfil</span>
      </a>
    </div>

    <!-- Avatar + Dropdown -->
    <div id="nav-user" class="nav-user" style="position: relative; cursor: pointer;">
      <!-- El JS generará esto dinámicamente:
           <div class="nav-user-circle"></div>
           <span class="nav-user-name"></span>
      -->
      <div id="user-menu" class="hidden" style="
          position: absolute;
          top: 48px; /* ajustar según navbar */
          right: 0;
          background: white;
          border-radius: 8px;
          box-shadow: 0 4px 12px rgba(0,0,0,0.15);
          min-width: 180px;
          z-index: 1000;
        ">
        <ul style="list-style: none; margin: 0; padding: 0;">
          <li style="border-bottom: 1px solid #eee;">
            <a href="../Perfil/perfil-seccion.html" style="display:block;padding:10px;text-decoration:none;color:#333;">Mi Perfil</a>
          </li>
          <li style="border-bottom: 1px solid #eee;">
            <a href="configuracion-perfil.html" style="display:block;padding:10px;text-decoration:none;color:#333;">Configuración</a>
          </li>
          <li>
            <a href="#" id="logoutBtn" style="display:block;padding:10px;text-decoration:none;color:#e00;">Cerrar sesión</a>
          </li>
        </ul>
      </div>
    </div>

  </div>

  <!-- Breadcrumb -->
  <div class="breadcrumb">
    <div class="breadcrumb-container">
      <a href="../inicio.html" class="breadcrumb-link">
        <i data-lucide="home"></i>
        <span>Inicio</span>
      </a>
      <span class="breadcrumb-separator">/</span>
      <a href="perfil-seccion.html" class="breadcrumb-link">
        <span>Mi Perfil</span>
      </a>
      <span class="breadcrumb-separator">/</span>
      <span class="breadcrumb-current">Configuración</span>
    </div>
  </div>
</nav>


    <!-- Config Header -->
    <section class="config-header">
      <div class="container">
        <a href="perfil-seccion.html" class="back-link">
          <i data-lucide="arrow-left"></i>
          <span>Volver a Mi Perfil</span>
        </a>
        
        <div class="config-header-content">
          <div class="config-icon">
            <i data-lucide="settings"></i>
          </div>
          <div>
            <h1 class="config-title">Configuración de Perfil</h1>
            <p class="config-subtitle">Personaliza tu información personal, educativa y preferencias vocacionales</p>
          </div>
        </div>
      </div>
    </section>

    <!-- Hidden Radio Inputs for Tabs -->
    <input type="radio" name="tabs" id="tab-personal" class="tab-input" checked>
    <input type="radio" name="tabs" id="tab-educativa" class="tab-input">
    <input type="radio" name="tabs" id="tab-preferencias" class="tab-input">
    <input type="radio" name="tabs" id="tab-privacidad" class="tab-input">
    <input type="radio" name="tabs" id="tab-notificaciones" class="tab-input">

    <!-- Tabs Navigation -->
    <section class="config-tabs">
      <div class="container">
        <div class="tabs-nav">
          <label for="tab-personal" class="tab-btn">
            <i data-lucide="user"></i>
            <span>Información Personal</span>
          </label>
          <label for="tab-privacidad" class="tab-btn">
            <i data-lucide="shield"></i>
            <span>Privacidad y Cuenta</span>
          </label>
        </div>
      </div>
    </section>

    <!-- Tab Content: Información Personal -->
   <section class="config-content">
  <div class="container">

    <!-- IMPORTANT: Un solo form que contiene todas las pestañas -->
    <form id="configForm" class="config-form">

      <!-- TAB Personal -->
      <div class="tab-content" data-tab="personal">
        <div class="content-header">
          <h2 class="content-title">Información Personal</h2>
          <p class="content-desc">Actualiza tu información básica y de contacto</p>
        </div>

        <!-- Profile Photo -->
        <div class="form-section">
          <h3 class="section-title">Foto de Perfil</h3>
          <div class="profile-photo-upload">
            <div class="photo-info">
              <div class="current-photo" id="current-photo"></div>
              <span class="profile-name" id="nombre-display"></span>
            </div>
            <div class="photo-actions">
              <label class="btn-upload">
                <i data-lucide="camera"></i>
                Cambiar foto
                <input id="file-photo" type="file" accept="image/*" hidden>
              </label>
              <button type="button" class="btn-remove" id="btn-remove-photo">
                <i data-lucide="trash-2"></i>
                Eliminar
              </button>
            </div>
          </div>
        </div>

        <!-- Basic Info -->
        <div class="form-section">
          <h3 class="section-title">Información Básica</h3>
          <div class="form-grid">
            <div class="form-group">
              <label for="nombre" class="form-label">Nombre completo *</label>
              <input type="text" id="nombre" name="nombre" class="form-input" value="" required>
            </div>

            <div class="form-group">
              <label for="email" class="form-label">Correo electrónico *</label>
              <input type="email" id="email" name="email" class="form-input" value="" required>
            </div>

            <div class="form-group">
              <label for="telefono" class="form-label">Teléfono</label>
              <input type="tel" id="telefono" name="telefono" class="form-input" value="">
            </div>

            <div class="form-group">
              <label for="fecha-nacimiento" class="form-label">Fecha de nacimiento</label>
              <input type="date" id="fecha-nacimiento" name="fechaNacimiento" class="form-input" value="">
            </div>

            <div class="form-group">
              <label for="genero" class="form-label">Género</label>
              <select id="genero" name="genero" class="form-select">
                <option value="">Seleccionar</option>
                <option value="femenino">Femenino</option>
                <option value="masculino">Masculino</option>
                <option value="otro">Otro</option>
                <option value="prefiero-no-decir">Prefiero no decir</option>
              </select>
            </div>

            <div class="form-group">
              <label for="ubicacion" class="form-label">Ubicación</label>
              <input type="text" id="ubicacion" name="ubicacion" class="form-input" value="">
            </div>
          </div>
        </div>

        <!-- Bio -->
        <div class="form-section">
          <h3 class="section-title">Biografía</h3>
          <div class="form-group">
            <label for="bio" class="form-label">Cuéntanos un poco sobre ti</label>
            <textarea id="bio" name="bio" class="form-textarea" rows="4"></textarea>
            <span class="form-hint">Máximo 300 caracteres</span>
          </div>
        </div>
      </div>

        <!-- Tab Content: Privacidad y Cuenta -->
        <div class="tab-content" data-tab="privacidad">
          <div class="content-header">
            <h2 class="content-title">Privacidad y Cuenta</h2>
            <p class="content-desc">Gestiona tu privacidad y seguridad de la cuenta</p>
          </div>

          <div class="config-form">
            <!-- Password -->
            <div class="form-section">
              <h3 class="section-title">Cambiar Contraseña</h3>
              <div class="form-grid">
                <div class="form-group full-width">
                  <label for="password-actual" class="form-label">Contraseña actual</label>
                  <input type="password" id="password-actual" class="form-input">
                </div>
                <div class="form-group">
                  <label for="password-nueva" class="form-label">Nueva contraseña</label>
                  <input type="password" id="password-nueva" class="form-input">
                </div>
                <div class="form-group">
                  <label for="password-confirmar" class="form-label">Confirmar nueva contraseña</label>
                  <input type="password" id="password-confirmar" class="form-input">
                </div>
              </div>
              <button type="button" id="btnGuardarPassword" class="btn-primary">
  Guardar nueva contraseña
</button>


            </div>

            <!-- Danger Zone -->
            <div class="form-section danger-zone">
              <h3 class="section-title">Zona de Peligro</h3>
              <div class="danger-actions">
                <div class="danger-item">
                  <div class="danger-info">
                    <h4>Descargar mis datos</h4>
                    <p>Descarga una copia de toda tu información</p>
                  </div>
                  <button type="button" class="btn-danger-secondary">
                    <i data-lucide="download"></i>
                    Descargar
                  </button>
                </div>

                <div class="danger-item">
                  <div class="danger-info">
                    <h4>Eliminar cuenta</h4>
                    <p>Elimina permanentemente tu cuenta y todos tus datos</p>
                  </div>
                  <button type="button" class="btn-danger">
                    <i data-lucide="trash-2"></i>
                    Eliminar cuenta
                  </button>
                  
                </div>
              </div>
            </div>

            <div class="form-actions">
              <button type="button" class="btn-secondary">Cancelar</button>
              <button type="submit" class="btn-primary">Guardar Cambios</button>
              <button type="button" id="logoutBtnConfig" class="btn-logout-red">Cerrar sesión</button>

            </div>
          </div>

        </div>

      </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
      <div class="container">
        <div class="footer-grid">
          <div class="footer-col">
            <h4 class="footer-title">OrientaVocacional</h4>
            <p class="footer-text">Tu compañero en el camino hacia la decisión de carrera correcta.</p>
            <div class="footer-contact">
              <p><i data-lucide="mail"></i> info@orientavocacional.com</p>
              <p><i data-lucide="phone"></i> +1 234 567 890</p>
              <p><i data-lucide="map-pin"></i> Lima, Perú</p>
            </div>
          </div>
          <div class="footer-col">
            <h4 class="footer-title">Acceso Rápido</h4>
            <ul class="footer-links">
              <li><a href="#">Dashboard</a></li>
              <li><a href="#">Test Vocacional</a></li>
              <li><a href="#">Explorar Carreras</a></li>
              <li><a href="#">Mis Favoritos</a></li>
            </ul>
          </div>
          <div class="footer-col">
            <h4 class="footer-title">Recursos</h4>
            <ul class="footer-links">
              <li><a href="#">Materiales Educativos</a></li>
              <li><a href="#">Chat con Estudiantes</a></li>
              <li><a href="#">Calculadoras</a></li>
              <li><a href="#">Universidades</a></li>
            </ul>
          </div>
          <div class="footer-col">
            <h4 class="footer-title">Mi Cuenta</h4>
            <ul class="footer-links">
              <li><a href="#">Mi Perfil</a></li>
              <li><a href="#">Configuración</a></li>
              <li><a href="#">Notificaciones</a></li>
              <li><a href="#">Reportes</a></li>
            </ul>
          </div>
        </div>
        <div class="footer-bottom">
          <p>&copy; 2024 OrientaVocacional. Todos los derechos reservados.</p>
          <div class="footer-social">
            <a href="#"><i data-lucide="facebook"></i></a>
            <a href="#"><i data-lucide="twitter"></i></a>
            <a href="#"><i data-lucide="instagram"></i></a>
            <a href="#"><i data-lucide="linkedin"></i></a>
          </div>
          <div class="footer-legal">
            <a href="#">Términos y Condiciones</a>
            <a href="#">Política de Privacidad</a>
            <a href="#">Ayuda</a>
          </div>
        </div>
      </div>
    </footer>

    <!-- Mobile Bottom Navigation -->
    <nav class="bottom-nav">
      <a href="../inicio.html" class="bottom-nav-item">
        <i data-lucide="home"></i>
      </a>
      <a href="../TestVocacional/test-vocacional-seccion.html" class="bottom-nav-item">
        <i data-lucide="clipboard-check"></i>
      </a>
      <a href="../ExplorarCarreras/explorar-carreras-seccion.html" class="bottom-nav-item">
        <i data-lucide="search"></i>
      </a>
      <a href="../Herramientas/herramientas-seccion.html" class="bottom-nav-item">
        <i data-lucide="clipboard-list"></i>
      </a>
      <a href="perfil-seccion.html" class="bottom-nav-item active">
        <i data-lucide="user"></i>
      </a>
    </nav>


    <script>
      lucide.createIcons();
    </script>
    <!-- Script de Confirmación Bonita -->
    <style>
      /* Estilo del fondo difuminado del modal */
      .modal-overlay {
        position: fixed;
        inset: 0;
        background: rgba(0, 0, 0, 0.4);
        display: flex;
        align-items: center;
        justify-content: center;
        backdrop-filter: blur(4px);
        z-index: 9999;
      }

      /* Cuadro del modal */
      .modal-box {
        background: #fff;
        border-radius: 16px;
        padding: 2rem;
        text-align: center;
        width: 90%;
        max-width: 400px;
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
        animation: popIn 0.25s ease;
      }

      .modal-box h2 {
        color: #333;
        margin-bottom: 1rem;
      }

      .modal-box p {
        color: #555;
        margin-bottom: 1.5rem;
      }

      .modal-buttons {
        display: flex;
        justify-content: center;
        gap: 1rem;
      }

      .modal-btn {
        padding: 0.6rem 1.4rem;
        border-radius: 8px;
        cursor: pointer;
        border: none;
        font-weight: 600;
        transition: 0.2s ease;
      }

      .modal-btn-confirm {
        background: #007bff;
        color: white;
      }

      .modal-btn-cancel {
        background: #eee;
        color: #333;
      }

      .modal-btn-confirm:hover {
        background: #0056b3;
      }

      .modal-btn-cancel:hover {
        background: #ddd;
      }

      @keyframes popIn {
        from { transform: scale(0.9); opacity: 0; }
        to { transform: scale(1); opacity: 1; }
      }
    </style>
<script>
    document.getElementById("logoutBtn").addEventListener("click", function () {
        // Limpiar datos de sesión
  localStorage.removeItem("sesionActiva");
sessionStorage.removeItem("sesionActiva");

        // Redirigir al login
    window.location.href = "/Crear cuentas/iniciar-sesion.html";
    });
</script>
<script>
// Cerrar sesión desde el menú del avatar
document.getElementById("logoutBtn").addEventListener("click", function () {
localStorage.removeItem("sesionActiva");
sessionStorage.removeItem("sesionActiva");

    window.location.href = "/Crear cuentas/iniciar-sesion.html";
});

// Cerrar sesión desde el botón rojo de Configuración
document.getElementById("logoutBtnConfig").addEventListener("click", function () {
localStorage.removeItem("sesionActiva");
sessionStorage.removeItem("sesionActiva");

    window.location.href = "/Crear cuentas/iniciar-sesion.html";
});
</script>
  <script src="/Crear cuentas/js/inicio.js"></script>

<script src="/pages/Perfil/js/configuracion-perfil.js"></script>
  <script src="/pages/Perfil/js/nuevo-perfil.js"></script>
  <script src="/pages/js/user-info.js"></script>
  <script>
document.addEventListener("DOMContentLoaded", () => {

  const K_USERS = "usuariosRegistrados";
  const K_SESSION = "usuarioActual";

  const readUsers = () => JSON.parse(localStorage.getItem(K_USERS)) || [];
  const writeUsers = (u) => localStorage.setItem(K_USERS, JSON.stringify(u));

  const getSession = () => JSON.parse(localStorage.getItem(K_SESSION));
  const setSession = (u) => {
    if (!u) return localStorage.removeItem(K_SESSION);
    localStorage.setItem(K_SESSION, JSON.stringify(u));
  };

  const btnEliminar = document.querySelector(".btn-danger"); 
  const modal = document.getElementById("modalEliminarCuenta");
  const btnConfirmar = document.getElementById("btnConfirmarEliminar");
  const btnCancelar = document.getElementById("btnCancelarEliminar");

  let usuario = getSession();

  if (!usuario) return; // no hay sesión → nada que eliminar

  // --- Abrir modal ---
  btnEliminar.addEventListener("click", () => {
    modal.style.display = "flex";
  });

  // --- Cancelar ---
  btnCancelar.addEventListener("click", () => {
    modal.style.display = "none";
  });

  // --- Confirmar eliminación ---
  btnConfirmar.addEventListener("click", () => {

    const usuarios = readUsers();

    // Eliminar al usuario usando su EMAIL (único)
    const nuevosUsuarios = usuarios.filter(u => u.email !== usuario.email);
    writeUsers(nuevosUsuarios);

    // Eliminar sesión
    setSession(null);

    // Cerrar modal
    modal.style.display = "none";

    // Redirigir
    window.location.href = "/Crear cuentas/iniciar-sesion.html";
  });

});

</script>

  <!-- Modal de Confirmación para Eliminar Cuenta -->
<div id="modalEliminarCuenta" class="modal-overlay" style="display: none;">
  <div class="modal-box">
    <h2>¿Eliminar tu cuenta?</h2>
    <p>Esta acción es permanente. Todos tus datos serán eliminados y no podrás recuperarlos.</p>

    <div class="modal-buttons">
      <button id="btnConfirmarEliminar" class="modal-btn modal-btn-confirm">Sí, eliminar</button>
      <button id="btnCancelarEliminar" class="modal-btn modal-btn-cancel">Cancelar</button>
    </div>
  </div>
</div>
<script>
document.addEventListener("DOMContentLoaded", () => {

  const usuario = JSON.parse(localStorage.getItem("usuarioActual"));

  // Si no hay sesión → al login
  if (!usuario) {
    window.location.href = "/Crear cuentas/iniciar-sesion.html";
    return;
  }

  // ---------- Mostrar en navbar ----------
  const navUser = document.getElementById("nav-user");

  if (navUser) {
    navUser.innerHTML = `
      <div class="nav-user-circle">${usuario.nombre[0]}</div>
      <span class="nav-user-name">${usuario.nombre}</span>
    `;
  }

  // ---------- Mostrar en Información Personal ----------
  // Foto inicial (iniciales)
  const currentPhoto = document.getElementById("current-photo");
  if (currentPhoto) {
    const iniciales = usuario.nombre
      .split(" ")
      .map(p => p[0])
      .join("")
      .toUpperCase();
    currentPhoto.textContent = iniciales;
  }

  // Nombre visible
  const nombreDisplay = document.getElementById("nombre-display");
  if (nombreDisplay) {
    nombreDisplay.textContent = usuario.nombre;
  }

  // Campos del formulario
  document.getElementById("nombre").value = usuario.nombre || "";
  document.getElementById("email").value = usuario.email || "";
  document.getElementById("telefono").value = usuario.telefono || "";
  document.getElementById("fecha-nacimiento").value = usuario.fechaNacimiento || "";
  document.getElementById("ubicacion").value = usuario.ubicacion || "";
  document.getElementById("bio").value = usuario.bio || "";
  document.getElementById("genero").value = usuario.genero || "";
});
</script>

  </body>
  </html>